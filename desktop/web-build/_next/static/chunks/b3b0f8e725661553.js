(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,37799,e=>{"use strict";var t=e.i(31001);let s={cache:"no-store"},r="";"u">typeof navigator&&navigator.userAgent&&(r+=navigator.userAgent);let i={sdk:{name:"JavaScript",version:"4.22.1"}};void 0!==t.default&&(t.default.versions.node&&-1===r.indexOf("Node")&&(i.runtime_env={name:"Node",version:t.default.versions.node}),t.default.versions.bun&&-1===r.indexOf("Bun")&&(i.runtime_env={name:"Bun",version:t.default.versions.bun})),"u">typeof Deno&&t.default.versions.bun&&-1===r.indexOf("Deno")&&(i.runtime_env={name:"Deno",version:Deno.version.deno});class n{constructor(e){this.params=e,!1===e.userAgent?this.userAgent=void 0:this.userAgent=(e=>r+(!1===e?"":" AssemblyAI/1.0 ("+Object.entries({...i,...e}).map(([e,t])=>t?`${e}=${t.name}/${t.version}`:"").join(" ")+")"))(e.userAgent||{})}async fetch(e,t){t={...s,...t};let r={Authorization:this.params.apiKey,"Content-Type":"application/json"};s?.headers&&(r={...r,...s.headers}),t?.headers&&(r={...r,...t.headers}),this.userAgent&&(r["User-Agent"]=this.userAgent,"u">typeof window&&"chrome"in window&&(r["AssemblyAI-Agent"]=this.userAgent)),t.headers=r,e.startsWith("http")||(e=this.params.baseUrl+e);let i=await fetch(e,t);if(i.status>=400){let e,t=await i.text();if(t){try{e=JSON.parse(t)}catch{}if(e?.error)throw Error(e.error);throw Error(t)}throw Error(`HTTP Error: ${i.status} ${i.statusText}`)}return i}async fetchJson(e,t){return(await this.fetch(e,t)).json()}}class o extends n{summary(e,t){return this.fetchJson("/lemur/v3/generate/summary",{method:"POST",body:JSON.stringify(e),signal:t})}questionAnswer(e,t){return this.fetchJson("/lemur/v3/generate/question-answer",{method:"POST",body:JSON.stringify(e),signal:t})}actionItems(e,t){return this.fetchJson("/lemur/v3/generate/action-items",{method:"POST",body:JSON.stringify(e),signal:t})}task(e,t){return this.fetchJson("/lemur/v3/generate/task",{method:"POST",body:JSON.stringify(e),signal:t})}getResponse(e,t){return this.fetchJson(`/lemur/v3/${e}`,{signal:t})}purgeRequestData(e,t){return this.fetchJson(`/lemur/v3/${e}`,{method:"DELETE",signal:t})}}let{WritableStream:a}="u">typeof window?window:e.g,c=WebSocket??e.g?.WebSocket??window?.WebSocket??self?.WebSocket,h=(e,t)=>t?new c(e,t):new c(e),l={4e3:"Sample rate must be a positive integer",4001:"Not Authorized",4002:"Insufficient funds",4003:"This feature is paid-only and requires you to add a credit card. Please visit https://app.assemblyai.com/ to add a credit card to your account.",4004:"Session ID does not exist",4008:"Session has expired",4010:"Session is closed",4029:"Rate limited",4030:"Unique session violation",4031:"Session Timeout",4032:"Audio too short",4033:"Audio too long",4034:"Audio too small to transcode",4100:"Bad JSON",4101:"Bad schema",4102:"Too many streams",4103:"This session has been reconnected. This WebSocket is no longer valid.",1013:"Reconnect attempts exhausted",4104:"Could not parse word boost parameter"};class d extends Error{}let m={4e3:"Sample rate must be a positive integer",4001:"Not Authorized",4002:"Insufficient funds",4003:"This feature is paid-only and requires you to add a credit card. Please visit https://app.assemblyai.com/ to add a credit card to your account.",4004:"Session ID does not exist",4008:"Session has expired",4010:"Session is closed",4029:"Rate limited",4030:"Unique session violation",4031:"Session Timeout",4032:"Audio too short",4033:"Audio too long",4034:"Audio too small to transcode",4101:"Bad schema",4102:"Too many streams",4103:"This session has been reconnected. This WebSocket is no longer valid."};class u extends Error{}let p='{"terminate_session":true}';class f{constructor(e){if(this.listeners={},this.realtimeUrl=e.realtimeUrl??"wss://api.assemblyai.com/v2/realtime/ws",this.sampleRate=e.sampleRate??16e3,this.wordBoost=e.wordBoost,this.encoding=e.encoding,this.endUtteranceSilenceThreshold=e.endUtteranceSilenceThreshold,this.disablePartialTranscripts=e.disablePartialTranscripts,"token"in e&&e.token&&(this.token=e.token),"apiKey"in e&&e.apiKey&&(this.apiKey=e.apiKey),!(this.token||this.apiKey))throw Error("API key or temporary token is required.")}connectionUrl(){let e=new URL(this.realtimeUrl);if("wss:"!==e.protocol)throw Error("Invalid protocol, must be wss");let t=new URLSearchParams;return this.token&&t.set("token",this.token),t.set("sample_rate",this.sampleRate.toString()),this.wordBoost&&this.wordBoost.length>0&&t.set("word_boost",JSON.stringify(this.wordBoost)),this.encoding&&t.set("encoding",this.encoding),t.set("enable_extra_session_information","true"),this.disablePartialTranscripts&&t.set("disable_partial_transcripts",this.disablePartialTranscripts.toString()),e.search=t.toString(),e}on(e,t){this.listeners[e]=t}connect(){return new Promise(e=>{if(this.socket)throw Error("Already connected");let t=this.connectionUrl();this.token?this.socket=h(t.toString()):(console.warn(`API key authentication is not supported for the RealtimeTranscriber in browser environment. Use temporary token authentication instead.
Learn more at https://github.com/AssemblyAI/assemblyai-node-sdk/blob/main/docs/compat.md#browser-compatibility.`),this.socket=h(t.toString(),{headers:{Authorization:this.apiKey}})),this.socket.binaryType="arraybuffer",this.socket.onopen=()=>{void 0!==this.endUtteranceSilenceThreshold&&null!==this.endUtteranceSilenceThreshold&&this.configureEndUtteranceSilenceThreshold(this.endUtteranceSilenceThreshold)},this.socket.onclose=({code:e,reason:t})=>{!t&&e in l&&(t=l[e]),this.listeners.close?.(e,t)},this.socket.onerror=e=>{e.error?this.listeners.error?.(e.error):this.listeners.error?.(Error(e.message))},this.socket.onmessage=({data:t})=>{let s=JSON.parse(t.toString());if("error"in s)return void this.listeners.error?.(new d(s.error));switch(s.message_type){case"SessionBegins":{let t={sessionId:s.session_id,expiresAt:new Date(s.expires_at)};e(t),this.listeners.open?.(t);break}case"PartialTranscript":s.created=new Date(s.created),this.listeners.transcript?.(s),this.listeners["transcript.partial"]?.(s);break;case"FinalTranscript":s.created=new Date(s.created),this.listeners.transcript?.(s),this.listeners["transcript.final"]?.(s);break;case"SessionInformation":this.listeners.session_information?.(s);break;case"SessionTerminated":this.sessionTerminatedResolve?.()}}})}sendAudio(e){this.send(e)}stream(){return new a({write:e=>{this.sendAudio(e)}})}forceEndUtterance(){this.send('{"force_end_utterance":true}')}configureEndUtteranceSilenceThreshold(e){this.send(`{"end_utterance_silence_threshold":${e}}`)}send(e){if(!this.socket||this.socket.readyState!==this.socket.OPEN)throw Error("Socket is not open for communication");this.socket.send(e)}async close(e=!0){if(this.socket){if(this.socket.readyState===this.socket.OPEN)if(e){let e=new Promise(e=>{this.sessionTerminatedResolve=e});this.socket.send(p),await e}else this.socket.send(p);this.socket?.removeAllListeners&&this.socket.removeAllListeners(),this.socket.close()}this.listeners={},this.socket=void 0}}class y extends f{}class w extends n{constructor(e){super(e),this.rtFactoryParams=e}createService(e){return this.transcriber(e)}transcriber(e){let t={...e};return t.token||t.apiKey||(t.apiKey=this.rtFactoryParams.apiKey),new f(t)}async createTemporaryToken(e){return(await this.fetchJson("/v2/realtime/token",{method:"POST",body:JSON.stringify(e)})).token}}class g extends w{}function b(e){return e.startsWith("http")||e.startsWith("https")||e.startsWith("data:")?null:e.startsWith("file://")?e.substring(7):e.startsWith("file:")?e.substring(5):e}class k extends n{constructor(e,t){super(e),this.files=t}async transcribe(e,t){let s=await this.submit(e);return await this.waitUntilReady(s.id,t)}async submit(e){let t,s;if("audio"in e){let{audio:r,...i}=e;if("string"==typeof r){let e=b(r);t=null!==e?await this.files.upload(e):r.startsWith("data:")?await this.files.upload(r):r}else t=await this.files.upload(r);s={...i,audio_url:t}}else s=e;return await this.fetchJson("/v2/transcript",{method:"POST",body:JSON.stringify(s)})}async create(e,t){let s=b(e.audio_url);null!==s&&(e.audio_url=await this.files.upload(s));let r=await this.fetchJson("/v2/transcript",{method:"POST",body:JSON.stringify(e)});return t?.poll??!0?await this.waitUntilReady(r.id,t):r}async waitUntilReady(e,t){let s=t?.pollingInterval??3e3,r=t?.pollingTimeout??-1,i=Date.now();for(;;){let t=await this.get(e);if("completed"===t.status||"error"===t.status)return t;if(r>0&&Date.now()-i>r)throw Error("Polling timeout");await new Promise(e=>setTimeout(e,s))}}get(e){return this.fetchJson(`/v2/transcript/${e}`)}async list(e){let t="/v2/transcript";"string"==typeof e?t=e:e&&(t=`${t}?${new URLSearchParams(Object.keys(e).map(t=>[t,e[t]?.toString()||""]))}`);let s=await this.fetchJson(t);for(let e of s.transcripts)e.created=new Date(e.created),e.completed&&(e.completed=new Date(e.completed));return s}delete(e){return this.fetchJson(`/v2/transcript/${e}`,{method:"DELETE"})}wordSearch(e,t){let s=new URLSearchParams({words:t.join(",")});return this.fetchJson(`/v2/transcript/${e}/word-search?${s.toString()}`)}sentences(e){return this.fetchJson(`/v2/transcript/${e}/sentences`)}paragraphs(e){return this.fetchJson(`/v2/transcript/${e}/paragraphs`)}async subtitles(e,t="srt",s){let r=`/v2/transcript/${e}/${t}`;if(s){let e=new URLSearchParams;e.set("chars_per_caption",s.toString()),r+=`?${e.toString()}`}let i=await this.fetch(r);return await i.text()}redactions(e){return this.redactedAudio(e)}redactedAudio(e){return this.fetchJson(`/v2/transcript/${e}/redacted-audio`)}async redactedAudioFile(e){let{redacted_audio_url:t,status:s}=await this.redactedAudio(e);if("redacted_audio_ready"!==s)throw Error(`Redacted audio status is ${s}`);let r=await fetch(t);if(!r.ok)throw Error(`Failed to fetch redacted audio: ${r.statusText}`);return{arrayBuffer:r.arrayBuffer.bind(r),blob:r.blob.bind(r),body:r.body,bodyUsed:r.bodyUsed}}}let S=async function(e){throw Error("Interacting with the file system is not supported in this environment.")};class v extends n{async upload(e){let t;return t="string"==typeof e?e.startsWith("data:")?function(e){let t=e.split(","),s=t[0].match(/:(.*?);/)[1],r=atob(t[1]),i=r.length,n=new Uint8Array(i);for(;i--;)n[i]=r.charCodeAt(i);return new Blob([n],{type:s})}(e):await S():e,(await this.fetchJson("/v2/upload",{method:"POST",body:t,headers:{"Content-Type":"application/octet-stream"},duplex:"half"})).upload_url}}let T='{"type":"Terminate"}';class A{constructor(e){if(this.listeners={},this.params={...e,websocketBaseUrl:e.websocketBaseUrl||"wss://streaming.assemblyai.com/v3/ws"},"token"in e&&e.token&&(this.token=e.token),"apiKey"in e&&e.apiKey&&(this.apiKey=e.apiKey),!(this.token||this.apiKey))throw Error("API key or temporary token is required.")}connectionUrl(){let e=new URL(this.params.websocketBaseUrl??"");if("wss:"!==e.protocol)throw Error("Invalid protocol, must be wss");let t=new URLSearchParams;return this.token&&t.set("token",this.token),t.set("sample_rate",this.params.sampleRate.toString()),this.params.endOfTurnConfidenceThreshold&&t.set("end_of_turn_confidence_threshold",this.params.endOfTurnConfidenceThreshold.toString()),this.params.minEndOfTurnSilenceWhenConfident&&t.set("min_end_of_turn_silence_when_confident",this.params.minEndOfTurnSilenceWhenConfident.toString()),this.params.maxTurnSilence&&t.set("max_turn_silence",this.params.maxTurnSilence.toString()),void 0!==this.params.vadThreshold&&t.set("vad_threshold",this.params.vadThreshold.toString()),this.params.formatTurns&&t.set("format_turns",this.params.formatTurns.toString()),this.params.encoding&&t.set("encoding",this.params.encoding.toString()),this.params.keytermsPrompt?t.set("keyterms_prompt",JSON.stringify(this.params.keytermsPrompt)):this.params.keyterms&&(console.warn("[Deprecation Warning] `keyterms` is deprecated and will be removed in a future release. Please use `keytermsPrompt` instead."),t.set("keyterms_prompt",JSON.stringify(this.params.keyterms))),this.params.filterProfanity&&t.set("filter_profanity",this.params.filterProfanity.toString()),this.params.speechModel&&t.set("speech_model",this.params.speechModel.toString()),void 0!==this.params.languageDetection&&t.set("language_detection",this.params.languageDetection.toString()),void 0!==this.params.inactivityTimeout&&t.set("inactivity_timeout",this.params.inactivityTimeout.toString()),e.search=t.toString(),e}on(e,t){this.listeners[e]=t}connect(){return new Promise(e=>{if(this.socket)throw Error("Already connected");let t=this.connectionUrl();this.token?this.socket=h(t.toString()):(console.warn(`API key authentication is not supported for the StreamingTranscriber in browser environment. Use temporary token authentication instead.
Learn more at https://github.com/AssemblyAI/assemblyai-node-sdk/blob/main/docs/compat.md#browser-compatibility.`),this.socket=h(t.toString(),{headers:{Authorization:this.apiKey}})),this.socket.binaryType="arraybuffer",this.socket.onopen=()=>{},this.socket.onclose=({code:e,reason:t})=>{!t&&e in m&&(t=m[e]),this.listeners.close?.(e,t)},this.socket.onerror=e=>{e.error?this.listeners.error?.(e.error):this.listeners.error?.(Error(e.message))},this.socket.onmessage=({data:t})=>{let s=JSON.parse(t.toString());if("error"in s)return void this.listeners.error?.(new u(s.error));switch(s.type){case"Begin":e(s),this.listeners.open?.(s);break;case"Turn":this.listeners.turn?.(s);break;case"Termination":this.sessionTerminatedResolve?.()}}})}stream(){return new a({write:e=>{this.sendAudio(e)}})}sendAudio(e){this.send(e)}send(e){if(!this.socket||this.socket.readyState!==this.socket.OPEN)throw Error("Socket is not open for communication");this.socket.send(e)}async close(e=!0){if(this.socket){if(this.socket.readyState===this.socket.OPEN)if(e){let e=new Promise(e=>{this.sessionTerminatedResolve=e});this.socket.send(T),await e}else this.socket.send(T);this.socket?.removeAllListeners&&this.socket.removeAllListeners(),this.socket.close()}this.listeners={},this.socket=void 0}}class _ extends n{constructor(e){super(e),this.baseServiceParams=e}transcriber(e){let t={...e};return t.token||t.apiKey||(t.apiKey=this.baseServiceParams.apiKey),new A(t)}async createTemporaryToken(e){let t=new URLSearchParams;Object.entries(e).forEach(([e,s])=>{null!=s&&t.append(e,String(s))});let s=t.toString(),r=s?`/v3/token?${s}`:"/v3/token";return(await this.fetchJson(r,{method:"GET"})).token}}class P{constructor(e){e.baseUrl=e.baseUrl||"https://api.assemblyai.com",e.baseUrl&&e.baseUrl.endsWith("/")&&(e.baseUrl=e.baseUrl.slice(0,-1)),this.files=new v(e),this.transcripts=new k(e,this.files),this.lemur=new o(e),this.realtime=new w(e),this.streaming=new _({...e,baseUrl:e.streamingBaseUrl||"https://streaming.assemblyai.com"})}}e.s(["AssemblyAI",()=>P,"FileService",()=>v,"LemurService",()=>o,"RealtimeService",()=>y,"RealtimeServiceFactory",()=>g,"RealtimeTranscriber",()=>f,"RealtimeTranscriberFactory",()=>w,"StreamingTranscriber",()=>A,"TranscriptService",()=>k])}]);